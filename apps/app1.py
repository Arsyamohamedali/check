import streamlit as st
import cv2
import numpy as np
import keras
from tensorflow.keras.preprocessing import image
import tensorflow as tf
import numpy as np 
from PIL import Image,ImageOps 


def app():
	new_model = keras.models.load_model("haemorrhage_modelnorm.h5")
	st.title("Haemorrhage Detection")
	st.markdown(
		"""
		<style>
		.reportview-container {
		background: url("data:image/jpeg;base64,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")
		}
		</style>
		""", unsafe_allow_html=True) 

	uploaded_file_hem = st.file_uploader("Choose a image file", type=['png','jpg','jpeg'])
	if uploaded_file_hem is not None:
		image = Image.open(uploaded_file_hem)	
		size = (128,128)
		image1=image.resize(size)
		image1=ImageOps.grayscale(image1)
		x = np.asarray(image1)
		x = np.expand_dims(x, axis=0)
		x=np.reshape(x,(1,128,128,1))
		x=x/255.0
		if(new_model.predict_classes(x)[0][0]==1):
			st.write('***Haemorrhage***')
			if st.button('Show Image'):
				st.image(image,channels='BGR',width=300)
		else:
			st.write('***Normal***')
			if st.button('Show Image'):
				st.image(image,channels='BGR',width=300)
		
  			

#if __name__ == '__main__':
	#app(
